# Контейнеризація
## Python
### 1. Створення базового Dockerfile з фіксацією залежностей
З метою фіксації версій залежностей, створимо знімок поточного середовища та запишемо його в окремий файл, на який будемо посилатися у Dockerfile на етапі встановлення залежностей:
```bash
pip freeze > requirements.txt
```

Базовий знімок, який було використано: `python:3.13`

Метрики:

| Час збірки | Розмір знімку |
| - | - |
| 25.4s | 1.12GB |

### 2. Перезбірка знімку після внесення змін у файл
Зміни було внесено у файл `build/index.html`.

Метрики:

| Час збірки | Розмір знімку |
| - | - |
| 12.4s | 1.12GB |

Час збірки зайняв вдвічи менше часу, оскільки більше не треба було завантажувати базовий образ.

З визначених у Dockerfile команд, лише одна була закешована:
```
=> CACHED [2/4] WORKDIR /app/spaceship  0.0s
```

### 3. Оптимізація кешування
Метрики першої збірки після оптимізації Dockerfile:

| Час збірки | Розмір знімку |
| - | - |
| 12.3s | 1.12GB |

Після першої збірки зміни було знову внесено у файл `build/index.html`.

Метрики:

| Час збірки | Розмір знімку |
| - | - |
| 2.7s | 1.12GB |

З визначених у Dockerfile команд, були закешовані:
```
=> CACHED [2/5] WORKDIR /app/spaceship                              0.0s
=> CACHED [3/5] COPY requirements.txt .                             0.0s
=> CACHED [4/5] RUN pip install --no-cache-dir -r requirements.txt  0.0s
```

### 4. Використання компактнішого базового знімку
Базовий знімок, який було використано: `python:3.13-alpine`

Перед збіркою, знімок було завантажено:
```bash
docker pull python:3.13-alpine
```

Метрики:

| Час збірки | Розмір знімку |
| - | - |
| 13.7s | 139MB |

Попри завантаження базового знімку, час збірки зайняв більше часу, оскільки через використання нового базового знімку кеш було втрачено.

### 5. Підключення сторонніх бібліотек
У файл `spaceship/routers/api.py` було додано новий endpoint, який використовує нову сторонню бібліотеку `numpy`.

Для виключення впливу кешування, перед кожною збіркою його було видалено:
```bash
docker builder prune --all
```

Метрики для `python:3.13`:
| Час збірки | Розмір знімку |
| - | - |
| 18.6s | 1.25GB |

Метрики для `python:3.13-alpine`:
| Час збірки | Розмір знімку |
| - | - |
| 20.1s | 281MB |

Бачимо, що знімок на базі Alpine збирається трохи довше ніж стандартний на базі Debian, але при цьому займає в понад чотири рази менше місця. При цьому дельта розміру відносно збірки без сторонніх бібліотек однакова для обох знімків.
